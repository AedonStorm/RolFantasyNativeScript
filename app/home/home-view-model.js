"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const observable_1 = require("data/observable");
const page_1 = require("tns-core-modules/ui/page/page");
const platform_1 = require("platform");
const enums_1 = require("tns-core-modules/ui/enums");
const AdventurePageController_1 = require("~/home/adventure-page/AdventurePageController");
const EncounterPageController_1 = require("~/home/encounter-page/EncounterPageController");
var PageState;
(function (PageState) {
    PageState[PageState["Home"] = 0] = "Home";
    PageState[PageState["Adventure"] = 1] = "Adventure";
    PageState[PageState["Encounter"] = 2] = "Encounter";
    PageState[PageState["Tabern"] = 3] = "Tabern";
})(PageState = exports.PageState || (exports.PageState = {}));
let bottomBarInteraction = true;
class HomeViewModel extends observable_1.Observable {
    constructor(page) {
        super();
        this.currentPageState = PageState.Home;
        this.activateButton = new page_1.Color(40, 255, 255, 255);
        this.pageWidth = 0;
        this.adventurePageController = null;
        this.encounterageController = null;
        this.page = page;
        this.pageWidth = platform_1.screen.mainScreen.widthDIPs;
        this.adventurePage = page.getViewById("adventure-page");
        this.encounterPage = page.getViewById("encounter-page");
        page.bindingContext = this;
    }
    switchPage(nextPageState) {
        if (nextPageState != this.currentPageState && bottomBarInteraction) {
            console.log("Current State: " + this.currentPageState.toString());
            console.log("Next State: " + nextPageState.toString());
            bottomBarInteraction = false;
            const currentPageId = PageState[this.currentPageState];
            const newPageId = PageState[nextPageState];
            this.page.getViewById("hightlightedBtn").col = nextPageState;
            switch (nextPageState) {
                case PageState.Home: {
                    this.pageAnimationOut(this.getCurrentView(), nextPageState);
                    this.currentPageState = nextPageState;
                    bottomBarInteraction = true;
                    break;
                }
                case PageState.Adventure: {
                    if (this.adventurePageController == null)
                        this.adventurePageController = new AdventurePageController_1.AdventurePageController;
                    this.pageAnimationIn(this.adventurePage, nextPageState);
                    break;
                }
                case PageState.Encounter: {
                    if (this.encounterageController == null)
                        this.encounterageController = new EncounterPageController_1.EncounterPageController;
                    this.pageAnimationIn(this.encounterPage, nextPageState);
                    break;
                }
                case PageState.Tabern: {
                    //statements 
                    break;
                }
                default: {
                    console.log("SwitchPage Error");
                    return;
                }
            }
        }
    }
    pageAnimationIn(pageAnim, nextPageState) {
        pageAnim.translateX = nextPageState > this.currentPageState ? this.pageWidth : -this.pageWidth;
        pageAnim.visibility = "visible";
        if (this.currentPageState != PageState.Home)
            this.pageAnimationOut(this.getCurrentView(), nextPageState);
        pageAnim.animate({ translate: { x: 0, y: 0 }, duration: 200, curve: enums_1.AnimationCurve.easeIn });
        this.currentPageState = nextPageState;
        bottomBarInteraction = true;
    }
    pageAnimationOut(pageAnim, nextPageState) {
        const finalPosition = nextPageState < this.currentPageState ? this.pageWidth : -this.pageWidth;
        pageAnim.animate({ translate: { x: finalPosition, y: 0 }, duration: 200, curve: enums_1.AnimationCurve.easeIn }).then(() => {
            pageAnim.visibility = "collapse";
        });
    }
    getCurrentView() {
        switch (this.currentPageState) {
            case PageState.Home: {
                break;
            }
            case PageState.Adventure: {
                return this.adventurePage;
            }
            case PageState.Encounter: {
                return this.encounterPage;
            }
            case PageState.Tabern: {
                //statements 
                break;
            }
            default: {
                console.log("getView Error");
                return;
            }
        }
    }
}
exports.HomeViewModel = HomeViewModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaG9tZS12aWV3LW1vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaG9tZS12aWV3LW1vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsZ0RBQTRDO0FBQzVDLHdEQUFpRTtBQUNqRSx1Q0FBaUM7QUFDakMscURBQXdEO0FBQ3hELDJGQUF1RjtBQUN2RiwyRkFBdUY7QUFFdkYsSUFBWSxTQUtYO0FBTEQsV0FBWSxTQUFTO0lBQ2pCLHlDQUFJLENBQUE7SUFDSixtREFBUyxDQUFBO0lBQ1QsbURBQVMsQ0FBQTtJQUNULDZDQUFNLENBQUE7QUFDVixDQUFDLEVBTFcsU0FBUyxHQUFULGlCQUFTLEtBQVQsaUJBQVMsUUFLcEI7QUFFRCxJQUFJLG9CQUFvQixHQUFHLElBQUksQ0FBQTtBQUMvQixtQkFBMkIsU0FBUSx1QkFBVTtJQVl6QyxZQUFZLElBQVU7UUFDbEIsS0FBSyxFQUFFLENBQUE7UUFYWCxxQkFBZ0IsR0FBYyxTQUFTLENBQUMsSUFBSSxDQUFBO1FBQzVDLG1CQUFjLEdBQVUsSUFBSSxZQUFLLENBQUMsRUFBRSxFQUFDLEdBQUcsRUFBQyxHQUFHLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFFakQsY0FBUyxHQUFHLENBQUMsQ0FBQTtRQUViLDRCQUF1QixHQUE0QixJQUFJLENBQUE7UUFDdkQsMkJBQXNCLEdBQTRCLElBQUksQ0FBQTtRQU1sRCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQTtRQUNoQixJQUFJLENBQUMsU0FBUyxHQUFHLGlCQUFNLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQTtRQUU1QyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQTtRQUN2RCxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQTtRQUN2RCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQTtJQUM5QixDQUFDO0lBRU0sVUFB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O1lBQ1QsQ0FBQztRQUNOLENBQUM7SUFDTCxDQUFDO0NBQ0o7QUFsR0Qsc0NBa0dDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gXCJkYXRhL29ic2VydmFibGVcIlxuaW1wb3J0IHsgUGFnZSwgQ29sb3IsIFZpZXcgfSBmcm9tIFwidG5zLWNvcmUtbW9kdWxlcy91aS9wYWdlL3BhZ2VcIlxuaW1wb3J0IHsgc2NyZWVuIH0gZnJvbSBcInBsYXRmb3JtXCJcbmltcG9ydCB7QW5pbWF0aW9uQ3VydmV9IGZyb20gXCJ0bnMtY29yZS1tb2R1bGVzL3VpL2VudW1zXCJcbmltcG9ydCB7IEFkdmVudHVyZVBhZ2VDb250cm9sbGVyIH0gZnJvbSBcIn4vaG9tZS9hZHZlbnR1cmUtcGFnZS9BZHZlbnR1cmVQYWdlQ29udHJvbGxlclwiXG5pbXBvcnQgeyBFbmNvdW50ZXJQYWdlQ29udHJvbGxlciB9IGZyb20gXCJ+L2hvbWUvZW5jb3VudGVyLXBhZ2UvRW5jb3VudGVyUGFnZUNvbnRyb2xsZXJcIlxuXG5leHBvcnQgZW51bSBQYWdlU3RhdGUge1xuICAgIEhvbWUsXG4gICAgQWR2ZW50dXJlLFxuICAgIEVuY291bnRlcixcbiAgICBUYWJlcm5cbn1cblxubGV0IGJvdHRvbUJhckludGVyYWN0aW9uID0gdHJ1ZVxuZXhwb3J0IGNsYXNzIEhvbWVWaWV3TW9kZWwgZXh0ZW5kcyBPYnNlcnZhYmxlIHtcbiAgICBcbiAgICBjdXJyZW50UGFnZVN0YXRlOiBQYWdlU3RhdGUgPSBQYWdlU3RhdGUuSG9tZVxuICAgIGFjdGl2YXRlQnV0dG9uOiBDb2xvciA9IG5ldyBDb2xvcig0MCwyNTUsMjU1LDI1NSlcbiAgICBwYWdlOiBQYWdlXG4gICAgcGFnZVdpZHRoID0gMFxuXG4gICAgYWR2ZW50dXJlUGFnZUNvbnRyb2xsZXI6IEFkdmVudHVyZVBhZ2VDb250cm9sbGVyID0gbnVsbFxuICAgIGVuY291bnRlcmFnZUNvbnRyb2xsZXI6IEVuY291bnRlclBhZ2VDb250cm9sbGVyID0gbnVsbFxuICAgIGFkdmVudHVyZVBhZ2U6IFZpZXdcbiAgICBlbmNvdW50ZXJQYWdlOiBWaWV3XG5cbiAgICBjb25zdHJ1Y3RvcihwYWdlOiBQYWdlKSB7XG4gICAgICAgIHN1cGVyKClcbiAgICAgICAgdGhpcy5wYWdlID0gcGFnZVxuICAgICAgICB0aGlzLnBhZ2VXaWR0aCA9IHNjcmVlbi5tYWluU2NyZWVuLndpZHRoRElQc1xuXG4gICAgICAgIHRoaXMuYWR2ZW50dXJlUGFnZSA9IHBhZ2UuZ2V0Vmlld0J5SWQoXCJhZHZlbnR1cmUtcGFnZVwiKVxuICAgICAgICB0aGlzLmVuY291bnRlclBhZ2UgPSBwYWdlLmdldFZpZXdCeUlkKFwiZW5jb3VudGVyLXBhZ2VcIilcbiAgICAgICAgcGFnZS5iaW5kaW5nQ29udGV4dCA9IHRoaXNcbiAgICB9XG4gICAgICAgIFxuICAgIHB1YmxpYyBzd2l0Y2hQYWdlKG5leHRQYWdlU3RhdGU6IFBhZ2VTdGF0ZSkge1xuICAgICAgICBpZiAobmV4dFBhZ2VTdGF0ZSAhPSB0aGlzLmN1cnJlbnRQYWdlU3RhdGUgJiYgYm90dG9tQmFySW50ZXJhY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3VycmVudCBTdGF0ZTogXCIgKyB0aGlzLmN1cnJlbnRQYWdlU3RhdGUudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTmV4dCBTdGF0ZTogXCIgKyBuZXh0UGFnZVN0YXRlLnRvU3RyaW5nKCkpXG5cbiAgICAgICAgICAgIGJvdHRvbUJhckludGVyYWN0aW9uID0gZmFsc2VcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQYWdlSWQ6IHN0cmluZyA9IFBhZ2VTdGF0ZVt0aGlzLmN1cnJlbnRQYWdlU3RhdGVdXG4gICAgICAgICAgICBjb25zdCBuZXdQYWdlSWQ6IHN0cmluZyA9IFBhZ2VTdGF0ZVtuZXh0UGFnZVN0YXRlXVxuICAgICAgICAgICAgdGhpcy5wYWdlLmdldFZpZXdCeUlkKFwiaGlnaHRsaWdodGVkQnRuXCIpLmNvbCA9IG5leHRQYWdlU3RhdGVcbiAgICAgICAgICAgIHN3aXRjaChuZXh0UGFnZVN0YXRlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBQYWdlU3RhdGUuSG9tZTogeyBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlQW5pbWF0aW9uT3V0KHRoaXMuZ2V0Q3VycmVudFZpZXcoKSwgbmV4dFBhZ2VTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZVN0YXRlID0gbmV4dFBhZ2VTdGF0ZSBcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tQmFySW50ZXJhY3Rpb24gPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgIGNhc2UgUGFnZVN0YXRlLkFkdmVudHVyZTogeyBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWR2ZW50dXJlUGFnZUNvbnRyb2xsZXIgPT0gbnVsbCkgIHRoaXMuYWR2ZW50dXJlUGFnZUNvbnRyb2xsZXIgPSBuZXcgQWR2ZW50dXJlUGFnZUNvbnRyb2xsZXJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlQW5pbWF0aW9uSW4odGhpcy5hZHZlbnR1cmVQYWdlLCBuZXh0UGFnZVN0YXRlKVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgIGNhc2UgUGFnZVN0YXRlLkVuY291bnRlcjogeyBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5jb3VudGVyYWdlQ29udHJvbGxlciA9PSBudWxsKSAgdGhpcy5lbmNvdW50ZXJhZ2VDb250cm9sbGVyID0gbmV3IEVuY291bnRlclBhZ2VDb250cm9sbGVyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZUFuaW1hdGlvbkluKHRoaXMuZW5jb3VudGVyUGFnZSwgbmV4dFBhZ2VTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICBjYXNlIFBhZ2VTdGF0ZS5UYWJlcm46IHsgXG4gICAgICAgICAgICAgICAgICAgIC8vc3RhdGVtZW50cyBcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgZGVmYXVsdDogeyBcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTd2l0Y2hQYWdlIEVycm9yXCIpXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgIH1cblxuICAgcHJpdmF0ZSBwYWdlQW5pbWF0aW9uSW4ocGFnZUFuaW06IFZpZXcsIG5leHRQYWdlU3RhdGU6IFBhZ2VTdGF0ZSkge1xuICAgICAgICBwYWdlQW5pbS50cmFuc2xhdGVYID0gbmV4dFBhZ2VTdGF0ZSA+IHRoaXMuY3VycmVudFBhZ2VTdGF0ZSA/IHRoaXMucGFnZVdpZHRoIDogLXRoaXMucGFnZVdpZHRoIFxuICAgICAgICBwYWdlQW5pbS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2VTdGF0ZSAhPSBQYWdlU3RhdGUuSG9tZSkgdGhpcy5wYWdlQW5pbWF0aW9uT3V0KHRoaXMuZ2V0Q3VycmVudFZpZXcoKSwgbmV4dFBhZ2VTdGF0ZSlcbiAgICAgICAgcGFnZUFuaW0uYW5pbWF0ZSh7dHJhbnNsYXRlOiB7IHg6IDAsIHk6IDB9LCBkdXJhdGlvbjogMjAwLCBjdXJ2ZTogQW5pbWF0aW9uQ3VydmUuZWFzZUlufSlcbiAgICAgICAgdGhpcy5jdXJyZW50UGFnZVN0YXRlID0gbmV4dFBhZ2VTdGF0ZVxuICAgICAgICBib3R0b21CYXJJbnRlcmFjdGlvbiA9IHRydWVcbiAgIH1cbiAgIHByaXZhdGUgcGFnZUFuaW1hdGlvbk91dChwYWdlQW5pbTogVmlldywgbmV4dFBhZ2VTdGF0ZTogUGFnZVN0YXRlKSB7XG4gICAgICAgY29uc3QgZmluYWxQb3NpdGlvbiA9IG5leHRQYWdlU3RhdGUgPCB0aGlzLmN1cnJlbnRQYWdlU3RhdGUgPyB0aGlzLnBhZ2VXaWR0aCA6IC10aGlzLnBhZ2VXaWR0aCBcbiAgICAgICAgcGFnZUFuaW0uYW5pbWF0ZSh7dHJhbnNsYXRlOiB7IHg6IGZpbmFsUG9zaXRpb24sIHk6IDB9LCBkdXJhdGlvbjogMjAwLCBjdXJ2ZTogQW5pbWF0aW9uQ3VydmUuZWFzZUlufSkudGhlbiggKCkgPT4ge1xuICAgICAgICAgICAgcGFnZUFuaW0udmlzaWJpbGl0eSA9IFwiY29sbGFwc2VcIlxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Q3VycmVudFZpZXcoKTogVmlldyB7XG4gICAgICAgIHN3aXRjaCh0aGlzLmN1cnJlbnRQYWdlU3RhdGUpIHtcbiAgICAgICAgICAgIGNhc2UgUGFnZVN0YXRlLkhvbWU6IHsgXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgIGNhc2UgUGFnZVN0YXRlLkFkdmVudHVyZToge1xuICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZHZlbnR1cmVQYWdlXG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGNhc2UgUGFnZVN0YXRlLkVuY291bnRlcjogeyBcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvdW50ZXJQYWdlXG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGNhc2UgUGFnZVN0YXRlLlRhYmVybjogeyBcbiAgICAgICAgICAgICAgICAvL3N0YXRlbWVudHMgXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgXG4gICAgICAgICAgICAgZGVmYXVsdDogeyBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImdldFZpZXcgRXJyb3JcIilcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59Il19